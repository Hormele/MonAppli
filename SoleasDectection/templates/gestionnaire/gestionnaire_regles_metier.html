{% load static %}

<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Règles Métier</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="{% static 'css/gestionnaire_regles_metier.css' %}" rel="stylesheet">
</head>
<body>

<div class="sidebar">
    <h2>Menu</h2>
    <ul>
        <li><a href="{% url 'dashboard_admin' %}">Tableau de bord Admin</a></li>
        <li><a href="{% url 'dashboard_accueil' %}">Accueil</a></li>
        <li><a href="{% url 'liste_campagnes' %}">Campagnes</a></li>
        <li><a href="{% url 'liste_datasets' %}">Datasets</a></li>
        <li><a href="{% url 'liste_utilisateurs' %}">Utilisateurs</a></li>
        <li><a href="{% url 'liste_modeles' %}">Modèles ML</a></li>
        <li><a href="{% url 'liste_campagne_test' %}">Campagne Test</a></li>
        <li><a href="{% url 'gestionnaire_regles_metier' %}" class="active">Gerer les regles metiers</a></li>
        <li><a href="{% url 'dashboard_gestionnaire' %}">Gestionnaire</a></li>
        <li><a href="{% url 'logout' %}">Déconnexion</a></li>
    </ul>
</div>

<div class="content">
    <h1>Gestion des Règles Métier</h1>

    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Nom</th>
                <th>Description</th>
                <th>Condition</th>
                <th>Active</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
        {% for regle in regles %}
            <tr>
                <td>{{ regle.id}}</td>
                <td>{{ regle.nom }}</td>
                <td>{{ regle.description }}</td>
                <td>{{ regle.condition }}</td>
                <td>
                    {% if regle.actif %}
                        <span style="color: green;" class="actif">Active</span>
                    {% else %}
                        <span style="color: red" class="inactif">Désactivée</span>
                    {% endif %}
                </td>
                <td>
                    <a href="{% url 'toggle_regle_metier' regle.id %}">
                        {% if regle.actif %}
                            <button class="btn btn-warning">Descativer</button>
                        {% else %}
                            <button class="btn btn-success">Activer</button>
                        {% endif %}
                    </a>
                    {% if request.user.role == 'admin' %}
                        | <a href="{% url 'modifier_regle_metier' regle.id %}">Modifier</a>
                        | <a href="{% url 'supprimer_regle_metier' regle.id %}">Supprimer</a>
                    {% endif %}
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

    {% if request.user.role == 'admin' %}
        <div class="ajout-regle">
            <a href="{% url 'ajouter_regle_metier' %}">+ Ajouter une nouvelle règle</a>
        </div>
    {% endif %}
</div>

<footer>
    <p>&copy; 2025 SoleasDetection. Tous droits réservés.</p>
</footer>

</body>
</html>